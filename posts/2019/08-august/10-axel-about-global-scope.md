---
title: Как на самом деле работают глобавльные переменные в JavaScript
description: Аксель Раушмайер объясняет нюансы работы с глобальными переменными в JavaScript
date: 2019-08-10
url: https://2ality.com/2019/07/global-scope.html
tags:
  - specification
  - js
  - es2015
layout: layouts/post.njk
---
Аксель Раушмайер в прошлом месяце написал неплохую статью о том, как работают глобальные переменные в JS — "How do JavaScript’s global variables really work?"

Перед объяснением нюансов работы с глобальными переменными в статье рассказывается, что такое область видимости (scope) и как она определяется на уровне спецификации. В спеке области видимости "реализуются" с помощью lexical environments, которые состоят из environment record (нечто похожее на словарь с ключами и значениями) и ссылки на внешний scope. Таким образом дерево вложенных друг в друга областей видимости представляется деревом связанных между собой lexical environments.

На самом верхнем уровне этого дерева находится "global environment", состоящий из двух компонент: "object environment record", который поддерживает связь с свойствами глобального объекта ( `window` / `self` в браузере и `global` в node.js), и "declarative environment record", который создаётся с помощью `const`, `let`, `class`. Эти части существуют независимо, что даёт возможность создавать биндинги с одинаковыми ключами в разных записях. При обращении к таким биндингам из кода будет побеждать declarative environment record. Если очень упростить, то можно сказать, что начиная со спецификации ES2015 в JavaScript появились два разных вида глобальных переменных.

Рекомендую почитать статью и посмотреть на примеры того, как это всё работает.

https://2ality.com/2019/07/global-scope.html
