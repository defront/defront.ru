---
title: Современный подход к загурзке JavaScript
description: Джейсон Миллер про улучшение производительности с помощью загрузки скриптов, использующих современный синтаксис
date: 2019-07-17
url: https://jasonformat.com/modern-script-loading/
tags:
  - js
  - esm
  - modules
  - performance 
layout: layouts/post.njk
---
Пару дней назад Джейсон Миллер из Google написал статью про несколько стратегий загрузки js-бандлов с современным синтаксисом — "Modern Script Loading".

Отдача скриптов с современным синтаксисом для актуальных браузеров может очень положительно отразиться на производительности. При этом нельзя забывать о старых браузерах, которые могут не поддерживать новый синтаксис. Для условной загрузки скриптов в стандарте предусмотрен специальный аттрибут `nomodule` у тега `script`. Если вставить на страницу два тега скрипт один с современным синтаксисом, а другой со старым и с атрибутом `nomodule`, тогда последний не будет загружаться в современных браузерах. Но есть проблема — этот трюк будет вызывать лишний фетчинг файлов в Edge и Safari.

Джейсон предлагает четыре решения возникшей проблемы:
1. Определение поддержки браузером современных модулей и вставка на страницу нужного бандла в рантайме
2. При формировании страницы на сервере определять User-Agent и вставлять в код страницы нужный скрипт
3. Использовать описанный выше паттерн nomodule/module, понимая, что у какой-то части пользователей будет происходить лишняя загрузка кода
4. Использование полифиллов в теге с аттрибутом `nomodule`

В конце статьи есть советы, что может подойти лучше всего для определённой ситуации, так как у всех подходов есть свои плюсы и минусы. В общем, статья полезная, рекомендую почитать.

https://jasonformat.com/modern-script-loading/
