---
title: Релиз Yarn 2
description: Обзор новых фич релиза — переезд в новый репозиторий, Zero-Installs, изменения в воркспейсах, поддержка Пролог и другое
date: 2020-01-25
url: https://dev.to/arcanis/introducing-yarn-2-4eh1
tags:
  - yarn
  - release
  - tool
layout: layouts/post.njk
---
Вчера вышел релиз Yarn 2. Маэл Нильсон рассказал про все возможности новой версии — "Introducing Yarn 2!".

Первая версия переходит в режим поддержки и переезжает в `yarnpkg/legacy`, новая версия будет жить в репозитории `yarnpkg/berry`. Для облегчения процесса миграции разработчики подготовили Migration Guide.

Была реализована идея Zero-Installs, которая включает в себя много функций, для того чтобы все зависимости были доступны вне зависимости от внешних факторов. По сути теперь возможно без проблем закоммитить кэш yarn в git (гораздо эффективнее чем версионирование node_modules) и все зависимости будут доступны сразу после клонирования репозитория.

Очень много изменений в воркспейсах. Упрощена установка зависимостей. Добавлена команда `yarn workspaces foreach`, которая выполняет команду для всех воркспейсов. Для упрощения релизов пакетов монорепы добавлен новый релизный воркфлоу с помощью команды `yarn version` (пока в экспериментальном режиме). Появилась очень интересная фича — workspace constraints — правила на языке Пролог, которые позволяют синхронизировать зависимости воркспейсов.

Yarn 2 поставляется вместе с простым интерпретатором командной строки (подобно sh), благодаря этому установочные скрипты будут работать независимо от операционной системы. Lockfile теперь использует yaml. Импорт зависимостей, не указанных в package.json, теперь запрещён. Улучшили вывод в консоль. Добавили команду `yarn dlx` для загрузки и выполнения пакетов. Добавили поддержку протоколов `patch:` и `portal:`.

Из внутренних изменений — Yarn перешёл на модульную архитектуру, кодовая база была переписана с Flow на TypeScript.

https://dev.to/arcanis/introducing-yarn-2-4eh1
