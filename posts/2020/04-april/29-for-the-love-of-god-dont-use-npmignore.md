---
title: Проблемы npmignore
description: Джеф Дик рассказывает про вред, который может наненсти .npmignore
date: 2020-04-29
url: https://medium.com/@jdxcode/for-the-love-of-god-dont-use-npmignore-f93c08909d8d
tags:
  - npm
layout: layouts/post.njk
---
В постмортеме инцидента с is-promise одна из проблем была в конфиге, в который не был добавлен новый файл. Это случилось из-за того, что автора библиотеки запутало наличие файла `.npmignore`. Когда писал пост про постмортем, нашёл статью Джефа Дики про вред `.npmignore` — "For the love of god, don’t use .npmignore".

В npm есть два механизма для исключения попадания ненужных файлов в пакет: файл `.npmignore` (blacklist) и секция files в `package.json` (whitelist). По умолчанию npm игнорирует файлы, которые находятся в `.gitignore`, но при добавлении в проект конфига `.npmignore` `.gitgnore` перестаёт учитываться. Из-за этого нюанса у автора статьи утекли данные для аутентификации в S3, поэтому он рекомендует использовать только белый список файлов в `package.json` (явное лучше неявного). Но `.npmignore` может быть полезен, когда надо исключить раскиданные по проекту юнит-тесты `__test__` / `*.test.js` и т.п.

К советам из статьи стоит прислушаться. Как минимум, можно начать с подозрением относиться к `.npmignore`.

https://medium.com/@jdxcode/for-the-love-of-god-dont-use-npmignore-f93c08909d8d
