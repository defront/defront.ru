---
title: ECMAScript и standalone block
description: Росс Кирслинг — участвует в разработке спецификации ECMAScript — написал статью про самую ужасающую часть спецификации
date: 2020-03-30
url: https://dev.to/rkirsling/tales-from-ecma-s-crypt-annex-b-3-3-56go 
tags:
  - js
  - specification
layout: layouts/post.njk
---
Росс Кирслинг — участвует в разработке спецификации ECMAScript — написал статью про самую ужасающую часть спецификации — "Tales from "Ecma's Crypt": Annex B.3.3".

В JavaScript всегда была возможность использовать блоки ( `{}` ) не только с операторами `if`, `while`, `for`, но и как обособленную синтаксическую конструкцию (standalone block). Спецификация не описывала ситуацию, когда внутри блока определялась функция, поэтому исторически в разных браузерах этот сценарий был реализован по-разному. Для исправления этой проблемы в спецификацию был добавлен раздел, который фактически говорит о том, что определение функции внутри блока должно себя вести одновременно как `var` и `let`. Например, вот этот код не в strict-режиме выведет в консоль `1`:

```js
var a = -1;
(function () {
  const printOuter = () => console.log(a);
  {
    a = 1;
    function a() {}
    a = 2;
    printOuter();
  }
})();
```

Довольно сложно уместить подробный разбор статьи в небольшой пост, поэтому рекомендую заглянуть в источник, если вас заинтересовал этот кейс.

https://dev.to/rkirsling/tales-from-ecma-s-crypt-annex-b-3-3-56go 
